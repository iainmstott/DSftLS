<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>BGY2011M Data Skills for the Life Sciences</title>
  <meta name="description" content="This workbook accompanies the University of Lincoln School of Life Sciences Level 2 Module BGY2011M Data Skills for the Life Sciences." />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="BGY2011M Data Skills for the Life Sciences" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This workbook accompanies the University of Lincoln School of Life Sciences Level 2 Module BGY2011M Data Skills for the Life Sciences." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="BGY2011M Data Skills for the Life Sciences" />
  
  <meta name="twitter:description" content="This workbook accompanies the University of Lincoln School of Life Sciences Level 2 Module BGY2011M Data Skills for the Life Sciences." />
  

<meta name="author" content="Module lead: IAIN STOTT / email istott@lincoln.ac.uk" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">BGY2011M Data Skills for the Life Sciences</h1>
<p class="author"><em>Module lead: IAIN STOTT / email <a href="mailto:istott@lincoln.ac.uk" class="email">istott@lincoln.ac.uk</a></em></p>
<p class="date"><em>Last updated 2020-08-20</em></p>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a><ul>
<li><a href="#this-book"><span class="toc-section-number">1.1</span> This book</a><ul>
<li><a href="#using-the-web-book"><span class="toc-section-number">1.1.1</span> Using the web book</a></li>
<li><a href="#web-book-contents"><span class="toc-section-number">1.1.2</span> Web book contents</a></li>
<li><a href="#learning-schedule"><span class="toc-section-number">1.1.3</span> Learning schedule</a></li>
</ul></li>
<li><a href="#the-analytical-process"><span class="toc-section-number">1.2</span> The analytical process</a></li>
<li><a href="#installing-r-and-rstudio"><span class="toc-section-number">1.3</span> Installing R and RStudio</a></li>
<li><a href="#why-r"><span class="toc-section-number">1.4</span> Why R?</a></li>
</ul></li>
<li><a href="#r-basics"><span class="toc-section-number">2</span> R BASICS</a><ul>
<li><a href="#resources"><span class="toc-section-number">2.0.1</span> RESOURCES</a></li>
<li><a href="#create-your-r-script"><span class="toc-section-number">2.0.2</span> Create your R Script</a></li>
<li><a href="#r-basics-1"><span class="toc-section-number">2.1</span> R BASICS</a></li>
<li><a href="#objects"><span class="toc-section-number">2.2</span> OBJECTS</a></li>
<li><a href="#classes"><span class="toc-section-number">2.3</span> CLASSES</a></li>
<li><a href="#class-types"><span class="toc-section-number">2.4</span> CLASS TYPES</a><ul>
<li><a href="#numeric-and-character"><span class="toc-section-number">2.4.1</span> numeric and character</a></li>
<li><a href="#factor"><span class="toc-section-number">2.4.2</span> factor</a></li>
<li><a href="#logical"><span class="toc-section-number">2.4.3</span> logical</a></li>
<li><a href="#data.frame"><span class="toc-section-number">2.4.4</span> data.frame</a></li>
</ul></li>
<li><a href="#final-tips"><span class="toc-section-number">2.5</span> FINAL TIPS</a></li>
</ul></li>
<li><a href="#single-variable-plots"><span class="toc-section-number">3</span> SINGLE VARIABLE PLOTS</a><ul>
<li><a href="#resources"><span class="toc-section-number">3.1</span> RESOURCES</a></li>
<li><a href="#packages"><span class="toc-section-number">3.2</span> PACKAGES</a></li>
<li><a href="#plotting-single-variables"><span class="toc-section-number">3.3</span> PLOTTING SINGLE VARIABLES</a></li>
<li><a href="#part-1"><span class="toc-section-number">3.4</span> PART 1</a></li>
<li><a href="#user-guide"><span class="toc-section-number">3.5</span> USER GUIDE</a></li>
<li><a href="#subsetting-data"><span class="toc-section-number">3.6</span> SUBSETTING DATA</a></li>
<li><a href="#data-visualisation-one-variable"><span class="toc-section-number">3.7</span> DATA VISUALISATION (ONE VARIABLE)</a><ul>
<li><a href="#forward-fold"><span class="toc-section-number">3.7.1</span> FORWARD FOLD</a></li>
<li><a href="#ruler-reaction"><span class="toc-section-number">3.7.2</span> RULER REACTION</a></li>
<li><a href="#paper-balls"><span class="toc-section-number">3.7.3</span> PAPER BALLS</a></li>
</ul></li>
<li><a href="#part-2"><span class="toc-section-number">3.8</span> PART 2</a></li>
</ul></li>
<li><a href="#data-handling-and-management"><span class="toc-section-number">4</span> DATA HANDLING AND MANAGEMENT</a><ul>
<li><a href="#resources"><span class="toc-section-number">4.1</span> RESOURCES</a></li>
<li><a href="#packages"><span class="toc-section-number">4.2</span> PACKAGES</a></li>
<li><a href="#data-handling"><span class="toc-section-number">4.3</span> DATA HANDLING</a></li>
<li><a href="#part-1"><span class="toc-section-number">4.4</span> PART 1</a></li>
<li><a href="#user-guide"><span class="toc-section-number">4.5</span> USER GUIDE</a></li>
<li><a href="#subsetting-data"><span class="toc-section-number">4.6</span> SUBSETTING DATA</a><ul>
<li><a href="#slice"><span class="toc-section-number">4.6.1</span> <code>slice()</code></a></li>
<li><a href="#select"><span class="toc-section-number">4.6.2</span> <code>select()</code></a></li>
<li><a href="#filter"><span class="toc-section-number">4.6.3</span> <code>filter()</code></a></li>
</ul></li>
<li><a href="#adding-variables"><span class="toc-section-number">4.7</span> ADDING VARIABLES</a><ul>
<li><a href="#mutate"><span class="toc-section-number">4.7.1</span> <code>mutate()</code></a></li>
</ul></li>
<li><a href="#part-2"><span class="toc-section-number">4.8</span> PART 2</a></li>
<li><a href="#final-tips"><span class="toc-section-number">4.9</span> FINAL TIPS</a></li>
</ul></li>
<li><a href="#two-variable-plots"><span class="toc-section-number">5</span> TWO-VARIABLE PLOTS</a><ul>
<li><a href="#resources"><span class="toc-section-number">5.1</span> RESOURCES</a></li>
<li><a href="#packages"><span class="toc-section-number">5.2</span> PACKAGES</a></li>
<li><a href="#plotting-multiple-variables"><span class="toc-section-number">5.3</span> PLOTTING MULTIPLE VARIABLES</a></li>
<li><a href="#part-1"><span class="toc-section-number">5.4</span> PART 1</a></li>
<li><a href="#user-guide"><span class="toc-section-number">5.5</span> USER GUIDE</a></li>
<li><a href="#subsetting-data"><span class="toc-section-number">5.6</span> SUBSETTING DATA</a></li>
<li><a href="#data-visualisation-two-variables"><span class="toc-section-number">5.7</span> DATA VISUALISATION (TWO VARIABLES)</a><ul>
<li><a href="#scatter-points-plots"><span class="toc-section-number">5.7.1</span> SCATTER (POINTS) PLOTS</a></li>
<li><a href="#box-plots"><span class="toc-section-number">5.7.2</span> BOX PLOTS</a></li>
<li><a href="#violin-plots"><span class="toc-section-number">5.7.3</span> VIOLIN PLOTS</a></li>
<li><a href="#bar-plots"><span class="toc-section-number">5.7.4</span> BAR PLOTS</a></li>
<li><a href="#experimental-design-nonindependence-and-bias"><span class="toc-section-number">5.7.5</span> EXPERIMENTAL DESIGN, NONINDEPENDENCE AND BIAS</a></li>
</ul></li>
<li><a href="#part-2"><span class="toc-section-number">5.8</span> PART 2</a></li>
</ul></li>
<li><a href="#references">References</a></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BGY2011M Data Skills for the Life Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="introduction" class="section level1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>Welcome to Data Skills for the Life Sciences! This page contains important
information on the module: it’s worth reading through carefully, and the
information will always be here for you to refer back to. The first few sections
describe everything you need to know to set yourself up for the course. It’s
really important you complete these as soon as possible.<br />
 </p>
<hr />
<div id="this-book" class="section level2">
<h2><span class="header-section-number">1.1</span> This book</h2>
<p>First, some <strong>information on this web book</strong>. This book accompanies every student for
the first 9 weeks of the module, after which the teaching and content start
to diverge for different programmes. This allows programs to learn different
analytical techniques which are relevant to their courses: some stay with this
content, and some do not. The learning and assessment schedule can be found at
the bottom of the page.</p>
<div id="using-the-web-book" class="section level3">
<h3><span class="header-section-number">1.1.1</span> Using the web book</h3>
<p>You will see some icons at the top of the page:</p>
<p><img src="gitbook_icons.jpg" title="Icons" /></p>
<p>From left to right these are:</p>
<ul>
<li>the <em>hamburger</em> icon on the left shows or hides the page navigation
sidebar.</li>
<li>The <em>magnifying glass</em> icon allows you to search the book for any
term you like.</li>
<li>The <em>edit</em> icon in the middle is not of interest (it redirects any
other web developers to a site where they can copy and edit the book).</li>
<li>The <em>download</em>
button allows you to download the book as a pdf (e.g. for printing out), or an epub
(for reading on an eReader). Videos and interactive content will NOT work in pdf
or epub formats (although these formats will contain relevant URLs). Therefore,
this web version should ideally be the one you work from primarily, and it will work
on any internet-enabled device with a screen through a web browser (although
perhaps smartphone screens are a little small).</li>
<li>The <em>information</em> icon gives
some useful information on keyboard shortcuts.</li>
</ul>
</div>
<div id="web-book-contents" class="section level3">
<h3><span class="header-section-number">1.1.2</span> Web book contents</h3>
<p>Within the text you will find instructional videos,
“chunks” of R code and R outputs including text and plots, and interactive
quizzes. Each chapter is arranged like this:</p>
<ul>
<li><strong>Part 1</strong> of each chapter uses a web application I wrote to help teach analysis
using R. It is available at iainmstott.shinyapps.io/ShinyGLiM. By interacting
with the app, you’ll learn how to code different tasks, and you’ll write that
code yourself alongside.</li>
<li><strong>Part 2</strong> of each chapter is an interactive quiz which tests your knowledge of the
topics and skills in Part 1. Here is an example:</li>
</ul>
<div style="overflow: hidden; padding-top: 66.66%; position: relative;">
<p><iframe style="border: 0; height: 100%; left: 0; position: absolute; top: 0; width: 100%;"
    src="https://ashbaldry.shinyapps.io/Pokemon_20Q/">
</iframe></p>
</div>
<ul>
<li><strong>Part 3</strong> of each chapter presents some analytical tasks for biological data
for you to code in R.<br />
 </li>
</ul>
<p>Code is always written using a <code>fixed width font</code> like Courier New, Consolas or
Lucida Console. My personal favourite at the moment is
<a href="https://fonts.google.com/specimen/Space+Mono">Space Mono</a>. The reason for this
is that all the letters line up vertically, which is far easier to read and crucial
for coding, where often lines will only be slightly different to one another.
<em>Code chunks</em> are collections of lines of code which do a certain thing. This
code will draw 1000 random numbers from a normal distribution with a mean of zero
and standard deviation of 1, then calculate the mean and standard deviation
(which of course should be approximately zero and one respectively):</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>random &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">mean</span>(random)</span></code></pre></div>
<pre><code>## [1] -0.002540417</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">sd</span>(random)</span></code></pre></div>
<pre><code>## [1] 0.9650165</code></pre>
<p> </p>
<p><em>Scripts</em> are files which contain many chunks of code.</p>
</div>
<div id="learning-schedule" class="section level3">
<h3><span class="header-section-number">1.1.3</span> Learning schedule</h3>
<p>Parts 1 and 2 of each chapter are to be completed at home each week, prior to the
online session. These should take 1-2 hours per chapter, although this will
definitely vary depending on the topic. Part 3 is to be
completed during the online sessions, when you will work in your tutor groups.
You may complete Parts 1 and 2 either individually, or in tutor groups, as you wish.</p>
<p>Information on the timetable, and both the formative and summative assessments,
are found at the bottom of the page.<br />
 </p>
<hr />
</div>
</div>
<div id="the-analytical-process" class="section level2">
<h2><span class="header-section-number">1.2</span> The analytical process</h2>
<p>This module is all about analysing data.
Any analytical process is really just a means of understanding your data, and
relationships between variables in that data. <em>That’s why I do not consider this</em>
<em>to be a course in statistics; it is a course in giving you the skills to</em>
<em>understand data.</em> Statistics is one part of that.<br />
 </p>
<div class="figure">
<img src="Process.png" title="The Analytical Process" alt="" />
<p class="caption">The analytical process and its feedbacks, from start to finish</p>
</div>
<p> </p>
<p>There is a process to analysis, with a few different steps and feedbacks between
them, as illustrated above. It’s important not to dive right into statistical
analysis without understanding your data, your variables and the relationships
between them first. For that reason, much of the course will be dedicated to
understanding data, and how to plot data.<br />
These steps forms the <strong>FIRST HALF of the course</strong>:</p>
<ul>
<li><strong>Tidy data</strong>
<ul>
<li>data exploration</li>
<li>data subsetting</li>
<li>data manipulation</li>
</ul></li>
<li><strong>Plots</strong>
<ul>
<li>Single-variable distributions and summary statistics</li>
<li>Two- and three-variable plots to explore hypotheses</li>
</ul></li>
</ul>
<p>Data handling and plotting is also the best vehicle to learn how to
code: data handling and plots are harder to code but easier to interpret,
whereas statistical analyses are easier to code but harder to interpret.</p>
<p>Equally, you cannot complete a statistical analysis without assessing how well
that model fits the data, and whether any ‘assumptions’ of your statistical
model are violated.<br />
These steps form the <strong>SECOND HALF of the course</strong>:</p>
<ul>
<li><strong>Model</strong>
<ul>
<li>fitting a statistical model</li>
</ul></li>
<li><strong>Model fit</strong>
<ul>
<li>assessing how well a statistical model fits the data</li>
</ul></li>
<li><strong>Results</strong>
<ul>
<li>Understanding and interpreting the results of a statistical model</li>
</ul></li>
</ul>
<p>The “statistical model” we will be working with is the
<em>general linear model (glm)</em>. This is a framework which brings together
many traditional statistical analyses. You will learn where these traditional
analyses fit into the glm framework.</p>
<p>There are naturally feedbacks between these steps, where new information may
mean you need to revise earlier steps.<br />
 </p>
<hr />
</div>
<div id="installing-r-and-rstudio" class="section level2">
<h2><span class="header-section-number">1.3</span> Installing R and RStudio</h2>
<p>We will be using a program called <em>RStudio</em> (the technical term for it is an
“Integrated Development Environment” or <em>IDE</em>), to “code” in a programming
language called <em>R</em>. The very first thing you need to do is install both of
these, and the following video walks you through that:</p>
<div style="overflow: hidden; padding-top: 56.25%; position: relative;">
<p><iframe style="border: 0; height: 100%; left: 0; position: absolute; top: 0; width: 100%;"
    src="https://www.youtube.com/embed/d7lARa168gk"
    frameborder="0" allow="accelerometer; autoplay; encrypted-media;
    gyroscope; picture-in-picture" allowfullscreen>
</iframe></p>
</div>
<p> </p>
<p> </p>
<p> </p>
<hr />
</div>
<div id="why-r" class="section level2">
<h2><span class="header-section-number">1.4</span> Why R?</h2>
<p>You may have come across other programs that allow you to work with data,
plot data and run statistical analyses. So why a programming language, and why
R?</p>
<p>There are a huge number of benefits to using R, listed here and elaborated on in
the video below.</p>
<ol style="list-style-type: decimal">
<li>It’s <strong><em>free</em></strong>.</li>
<li>It’s <strong><em>open source</em></strong>.</li>
<li>It’s <strong><em>cross-platform</em></strong></li>
<li>It’s <strong><em>transparent</em></strong> and <strong><em>replicable</em></strong></li>
<li>It’s <strong><em>powerful</em></strong> and <strong><em>fast</em></strong></li>
<li>It’s <strong><em>flexible</em></strong><br />
 </li>
</ol>
<p>Think of R like the language you’re writing in, and
RStudio like Microsoft Word, i.e. a program that allows you to write stuff,
edit documents, save them and generally work with them. Writing R allows you
to speak to the computer by “running” your code, and the computer will accordingly
do certain tasks like calculate something, create a plot or do a statistical
analysis. RStudio enables you to write code, run code and view the outputs of
your hard labour! Lots of things can be done with what is called <em>base R</em>,
which load every time you start R (and therefore every time you start RStudio, as
R is run from within RStudio). However some tasks require add-on <em>packages</em> with
extra information: think of these like dictionaries of extra vocabulary and grammar
which allow R to communicate with the computer in more elaborate ways.</p>
<p>This video explains some of these concepts:<br />
 </p>
<div style="overflow: hidden; padding-top: 56.25%; position: relative;">
<p><iframe style="border: 0; height: 100%; left: 0; position: absolute; top: 0; width: 100%;"
    src="https://www.youtube.com/embed/-BLSElo-ZP4"
    frameborder="0" allow="accelerometer; autoplay; encrypted-media;
    gyroscope; picture-in-picture" allowfullscreen>
</iframe></p>
</div>
<p> </p>
<p> </p>
<p> </p>
<!--chapter:end:index.Rmd-->
</div>
</div>
<div id="r-basics" class="section level1">
<h1><span class="header-section-number">2</span> R BASICS</h1>
<p>Welcome to your first R tutorial! In this tutorial we’ll be covering the very basics of R, which is a programming language originally developed for
understanding data and doing statistics. This tutorial includes:</p>
<ul>
<li>Why programming is important, and why its popularity in both research
and industry is increasing</li>
<li>What programming languages (and specifically R) are
<ul>
<li>how programming works</li>
<li>types of programming language (especially R)</li>
<li>the anatomy (“vocabulary” and “grammar”) of R code</li>
</ul></li>
<li>The many benefits of using R</li>
<li>What RStudio is, and how RStudio works with R</li>
<li>The structure of R
<ul>
<li>base coding <em>packages</em></li>
<li>add-on packages</li>
</ul></li>
</ul>
<p>With this information, we’ll put our newfound knowledge into practice and
do some basic coding in R to get used to this new way of working with data.</p>
<p>For those of you who are familiar with R already, this should still serve as a
useful reminder (and won’t take very long at all!)<br />
 </p>
<hr />
<div id="resources" class="section level3">
<h3><span class="header-section-number">2.0.1</span> RESOURCES</h3>
<p>These resources will help you get to grips with R and RStudio. It’s well worth
taking a look: even the most experienced of us make the simplest of mistakes,
and having the resources to refer back to is incredibly useful.</p>
<p>Books:</p>
<ul>
<li>Beckerman, Childs &amp; Petchey (2017) <em>Getting started with R, an
introduction for Biologists</em>, 2nd ed. pp 1 - 34, Chapter 1, “Getting and
getting acquainted with R”.
 </li>
</ul>
<p>Cheatsheets:</p>
<ul>
<li><a href="https://github.com/rstudio/cheatsheets/raw/master/rstudio-ide.pdf">RStudio IDE cheatsheet</a> by RStudio</li>
<li><a href="http://github.com/rstudio/cheatsheets/raw/master/base-r.pdf">base-R cheatsheet</a> by RStudio
 </li>
</ul>
<p>Web links:</p>
<ul>
<li><a href="https://education.rstudio.com/learn/beginner">R for beginners</a> by RStudio<br />
 </li>
</ul>
<hr />
</div>
<div id="create-your-r-script" class="section level3">
<h3><span class="header-section-number">2.0.2</span> Create your R Script</h3>
<p>!!! video here</p>
<p>R code is saved in a file with the extension <code>.R</code>. In the same way as Micosoft
Word knows to open files with <code>.docx</code> extensions and Adobe Reader knows to
open files with <code>.pdf</code> extensions, RStudio knows to open files with <code>.R</code>
extensions, and to work with them in certain ways.</p>
<p>In this course we’ll work primarily with two different code documents: one
for Part 1 of the worksheets, and one for Part 2. By the end of the course,
these two files will each have a complete analysis, including:</p>
<p>Create a .R file in the folder you wish to use as your working directory. Type
in the commands* in this worksheet and check your outputs against the outputs
below. This worksheet contains <em>Questions</em> and <em>Tasks</em> in <em>italics</em>: note
down the answers you get, and we’ll go through them at the end of the session.</p>
<p>*typing really is better than copy-pasting, as it helps the R language stick in your
brain better. It’s a better approach to learning programming. But then every time I teach R,
someone copy-pastes… so I guess some of you will too.</p>
<hr />
</div>
<div id="r-basics-1" class="section level2">
<h2><span class="header-section-number">2.1</span> R BASICS</h2>
<p>With this worksheet, we’ll go through some basics of working with R. This will
include learning components of R code:</p>
<ul>
<li>objects
<ul>
<li>assignment to objects</li>
<li>object classes</li>
</ul></li>
<li>functions
<ul>
<li>function arguments</li>
</ul></li>
<li>outputs</li>
<li>comments<br />
</li>
</ul>
<p>R is used for <em>Object-Oriented Programming (OOP)</em>, which means that in R, you
create <strong>objects</strong> (packets of data which is saved in the computer’s RAM), which
can be recalled and used throughout that R session, until they are either
overwritten or removed. These objects have different <strong>classes</strong>, which define
what the object is. R will work with objects differently, depending on their
class: for example, it is possible to calculate the mean of a vector of numbers,
but not of a vector of words!<br />
<br />
</p>
<p>Think of this like… Minecraft. You create <em>bricks</em> (our <em>objects</em>)
of different <em>types</em> (our <em>classes</em>) to build a world within your session. You
can do certain things with some types of brick, but not others. At the
end of an R session, like in Minecraft, you can delete your world, or you can
save your session.<br />
<br />
</p>
<p>First of all, create a new .R file in the folder of your choice. You’ll type
code from this exercise into that file, with comments, and save it so that
you can use it again in the future, and re-create exactly the same results.
This is important for scientific TRANSPARENCY and REPRODUCIBILITY: this
way, others can clearly understand what you’ve done with your data, and
they can re-create the same results that you have.<br />
<br />
</p>
<hr />
</div>
<div id="objects" class="section level2">
<h2><span class="header-section-number">2.2</span> OBJECTS</h2>
<p>This section covers how to create objects, what classes mean, what functions
are and how they work.<br />
<br />
</p>
<p>Objects are created using <strong>functions</strong>. functions take the form
<code>function(argument1, argument2, ...)</code>. Each function takes unique arguments,
and a different object is created depending on what these arguments are.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>numbers &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">1</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>numbers</span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<p><br />
</p>
<p>The object <code>numbers</code> is a <strong>numeric vector</strong>: this means a sequence of
numbers. You can see that the class of <code>numbers</code> is numeric:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">class</span>(numbers)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<p><br />
</p>
<p>We can do certain things with this vector. For example, we might want to see a
summary about it, find out what its length is, or calculate the mean:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">summary</span>(numbers)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    1.00    3.25    5.50    5.50    7.75   10.00</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">length</span>(numbers)</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">mean</span>(numbers)</span></code></pre></div>
<pre><code>## [1] 5.5</code></pre>
<p><br />
</p>
<p>We can change or add arguments to make a function behave differently. For example:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">summary</span>(numbers, <span class="dt">digits =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##       1       3       6       6       8      10</code></pre>
<p><br />
<em>Question: How has this changed the output?</em><br />
<br />
</p>
<p>Going back to the original creation of the <code>numbers</code> object, we can change the
arguments to create a different object.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>numbers2 &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">20</span>, <span class="dv">2</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a>numbers2</span></code></pre></div>
<pre><code>##  [1]  2  4  6  8 10 12 14 16 18 20</code></pre>
<p><br />
</p>
<p><em>Question: What do the three arguments of the <code>seq</code> function mean?</em><br />
<br />
</p>
<p>Maybe now we want to use <code>numbers1</code> instead of <code>numbers</code>. We can create <code>numbers1</code>
which has the same value as <code>numbers</code>, and remove <code>numbers</code>:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>numbers1 &lt;-<span class="st"> </span>numbers</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="kw">rm</span>(numbers)</span></code></pre></div>
<p><br />
</p>
<p>As you can see, we can create an object from another object. In fact, you can
create object using multiple other objects, and objects can be created in
different ways.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>numbers1 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span>  <span class="co"># this gives the same values as seq(1, 10, 1)</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>numbers2 &lt;-<span class="st"> </span>numbers1 <span class="op">*</span><span class="st"> </span><span class="dv">2</span></span></code></pre></div>
<p><br />
</p>
<p>We use the <code>#</code> (hash) symbol to create a comment: nothing after it will be run
as code. It’s good practise to comment your code as you go, so when you
go back to it later, it makes sense to you. Trust me, you make life so much
easier for your future self if you comment well!<br />
<br />
</p>
<p><em>Task: create an object called <code>numbers3</code> which is the three-times-table up to
30.</em><br />
<br />
</p>
<hr />
</div>
<div id="classes" class="section level2">
<h2><span class="header-section-number">2.3</span> CLASSES</h2>
<p>We’ll create a new object which looks kinda like our original object, but is
not actually the same.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>characters1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;7&quot;</span>, <span class="st">&quot;8&quot;</span>, <span class="st">&quot;9&quot;</span>, <span class="st">&quot;10&quot;</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a>characters1</span></code></pre></div>
<pre><code>##  [1] &quot;1&quot;  &quot;2&quot;  &quot;3&quot;  &quot;4&quot;  &quot;5&quot;  &quot;6&quot;  &quot;7&quot;  &quot;8&quot;  &quot;9&quot;  &quot;10&quot;</code></pre>
<p><br />
</p>
<p>The <code>c</code> function is really important. It means concatenate, and basically
glues together the arguments you give it. The <code>characters1</code> object
looks similar to the <code>numbers1</code> object, but it’s not. Note the quote marks
around each vector element.<br />
<br />
</p>
<p><em>Question: find out the class of <code>characters1</code>.</em><br />
<br />
</p>
<p>What happens if we try to do the same things with this vector?</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">summary</span>(characters1)</span></code></pre></div>
<pre><code>##    Length     Class      Mode 
##        10 character character</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">length</span>(characters1)</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">mean</span>(characters1)</span></code></pre></div>
<pre><code>## Warning in mean.default(characters1): argument is not numeric or logical:
## returning NA</code></pre>
<pre><code>## [1] NA</code></pre>
<p><br />
</p>
<p>One of these functions went kinda wrong. As far as R is concerned, the
elements of <code>characters1</code> are words, and it can’t calculate the mean of some
words. It returns <code>NA</code>, meaning Not Applicable: R code for something which
doesn’t exist or is missing. The Warning message makes sure you’re aware that
something went wrong. R can also return an Error message, which tells you that
the function has failed. Pay attention to these messages: usually if you get
an Error or a Warning, much of your subsequent code will fail as it depends
on things going right.<br />
<br />
</p>
<p>It’s possible to convert things between different classes, although the
behaviour is sometimes unpredictable so be careful!</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>characters2 &lt;-<span class="st"> </span><span class="kw">as.character</span>(numbers2)</span>
<span id="cb30-2"><a href="#cb30-2"></a>characters2</span></code></pre></div>
<pre><code>##  [1] &quot;2&quot;  &quot;4&quot;  &quot;6&quot;  &quot;8&quot;  &quot;10&quot; &quot;12&quot; &quot;14&quot; &quot;16&quot; &quot;18&quot; &quot;20&quot;</code></pre>
<p><br />
</p>
<hr />
</div>
<div id="class-types" class="section level2">
<h2><span class="header-section-number">2.4</span> CLASS TYPES</h2>
<p>There are 5 different class types that it’s important to know at this point.</p>
<ul>
<li><strong>numeric</strong></li>
<li><strong>character</strong></li>
<li><strong>factor</strong></li>
<li><strong>logical</strong></li>
<li><strong>data.frame</strong></li>
</ul>
<div id="numeric-and-character" class="section level3">
<h3><span class="header-section-number">2.4.1</span> numeric and character</h3>
<p>We’ve encountered numeric and character. Let’s create slightly longer vectors:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>num &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">25</span>)</span>
<span id="cb32-2"><a href="#cb32-2"></a>num</span></code></pre></div>
<pre><code>##  [1] 0.95378365 0.66128182 0.29616375 0.20226427 0.24959183 0.10264077
##  [7] 0.72792362 0.52232786 0.82871118 0.30631548 0.20406969 0.21810233
## [13] 0.72143560 0.63123410 0.59615276 0.52792806 0.27506171 0.13842224
## [19] 0.42913518 0.73438536 0.68862441 0.32577386 0.07553500 0.43765389
## [25] 0.08764673</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>char &lt;-<span class="st"> </span>LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">25</span>]</span>
<span id="cb34-2"><a href="#cb34-2"></a>char</span></code></pre></div>
<pre><code>##  [1] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; &quot;E&quot; &quot;F&quot; &quot;G&quot; &quot;H&quot; &quot;I&quot; &quot;J&quot; &quot;K&quot; &quot;L&quot; &quot;M&quot; &quot;N&quot; &quot;O&quot; &quot;P&quot; &quot;Q&quot; &quot;R&quot; &quot;S&quot;
## [20] &quot;T&quot; &quot;U&quot; &quot;V&quot; &quot;W&quot; &quot;X&quot; &quot;Y&quot;</code></pre>
<p><br />
</p>
<p>There are a few new things here. The <code>runif</code> function generates random numbers
between 0 and 1. The <code>LETTERS</code> object exists already when you load R, and
contains the alphabet.<br />
</p>
<p>It’s important to understand how different vectors ‘work’, but most of this
experience comes with time. Here’s an example:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>num <span class="op">*</span><span class="st"> </span><span class="dv">10</span></span></code></pre></div>
<pre><code>##  [1] 9.5378365 6.6128182 2.9616375 2.0226427 2.4959183 1.0264077 7.2792362
##  [8] 5.2232786 8.2871118 3.0631548 2.0406969 2.1810233 7.2143560 6.3123410
## [15] 5.9615276 5.2792806 2.7506171 1.3842224 4.2913518 7.3438536 6.8862441
## [22] 3.2577386 0.7553500 4.3765389 0.8764673</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>num <span class="op">-</span><span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">25</span>, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##  [1]  -0.04621635  -1.33871818  -2.70383625  -3.79773573  -4.75040817
##  [6]  -5.89735923  -6.27207638  -7.47767214  -8.17128882  -9.69368452
## [11] -10.79593031 -11.78189767 -12.27856440 -13.36876590 -14.40384724
## [16] -15.47207194 -16.72493829 -17.86157776 -18.57086482 -19.26561464
## [21] -20.31137559 -21.67422614 -22.92446500 -23.56234611 -24.91235327</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>num <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">-10</span>)</span></code></pre></div>
<pre><code>## Warning in num * c(10, -10): longer object length is not a multiple of shorter
## object length</code></pre>
<pre><code>##  [1]  9.5378365 -6.6128182  2.9616375 -2.0226427  2.4959183 -1.0264077
##  [7]  7.2792362 -5.2232786  8.2871118 -3.0631548  2.0406969 -2.1810233
## [13]  7.2143560 -6.3123410  5.9615276 -5.2792806  2.7506171 -1.3842224
## [19]  4.2913518 -7.3438536  6.8862441 -3.2577386  0.7553500 -4.3765389
## [25]  0.8764673</code></pre>
<p><br />
</p>
<p><em>Question: what’s happened for each of those lines of code? What does the Warning
message mean after running the final line?</em><br />
 </p>
</div>
<div id="factor" class="section level3">
<h3><span class="header-section-number">2.4.2</span> factor</h3>
<p>A <strong>factor</strong> object is like a character object, but recognises groups of elements
which are the same, called <em>levels</em>. Let’s take a look:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>fac &lt;-<span class="st"> </span><span class="kw">rep</span>(LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="dv">5</span>)</span>
<span id="cb43-2"><a href="#cb43-2"></a>fac &lt;-<span class="st"> </span><span class="kw">as.factor</span>(fac)</span></code></pre></div>
<p><br />
</p>
<p>We use the square brackets to choose which letters we
want: we choose A, B, C, D and E. The <code>rep</code> function means repeat, so we
repeat A to E five times, to give a vector that has a length of 25.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="kw">summary</span>(fac)</span></code></pre></div>
<pre><code>## A B C D E 
## 5 5 5 5 5</code></pre>
<p><br />
</p>
<p>We can see from the summary that R recognises the five different factor levels,
A through E.<br />
<br />
</p>
</div>
<div id="logical" class="section level3">
<h3><span class="header-section-number">2.4.3</span> logical</h3>
<p>Logical objects are perhaps hard to understand at first, but they’re simple
really. They basically indicate whether something is <code>TRUE</code> or <code>FALSE</code>. They
usually relate to a question we ask of our data:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>over0<span class="fl">.5</span> &lt;-<span class="st"> </span>num <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb46-2"><a href="#cb46-2"></a>over0<span class="fl">.5</span></span></code></pre></div>
<pre><code>##  [1]  TRUE  TRUE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE FALSE FALSE FALSE
## [13]  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE
## [25] FALSE</code></pre>
<p><br />
</p>
<p>The result is information on which of your random data are higher than 0.5.<br />
<br />
</p>
<p><em>Question: Do you have the same value for <code>over0.5</code> as your neighbour? Why?</em><br />
<br />
</p>
<p>There are lots of questions you can ask of your data, many functions you’ll
encounter on your R journey e.g. </p>
<ul>
<li><code>&gt;</code> greater than</li>
<li><code>&gt;=</code> greater than or equal to</li>
<li><code>&lt;</code> less than</li>
<li><code>&lt;=</code> less than or equal to</li>
<li><code>==</code> exactly equal to</li>
<li><code>%in%</code><br />
</li>
</ul>
<p>Let’s have a look at that last function. It tells us whether a value or values
(on the left) exist in the data (on the right). For example:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>numbers2 <span class="op">%in%</span><span class="st"> </span>numbers1</span></code></pre></div>
<pre><code>##  [1]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE</code></pre>
<p><br />
</p>
<p>This tells you which elements of <code>numbers2</code> are numbers in <code>numbers1</code>, i.e. 
which elements of <code>numbers2</code> are less than or equal to 10.<br />
<br />
</p>
<p><em>Task: show a different way to find out which elements of <code>numbers2</code> are less
than or equal to 10.</em><br />
<br />
</p>
<p>It’s not necessary when using <code>%in%</code> for the two vectors to have the same length.<br />
<br />
</p>
<p><em>Task: show code to find out which elements of <code>char</code> contain letters found in <code>fac</code>?</em><br />
<br />
</p>
</div>
<div id="data.frame" class="section level3">
<h3><span class="header-section-number">2.4.4</span> data.frame</h3>
<p>Finally, we’ll encounter the <code>data.frame</code>. This is the way most data is
stored for data analysis. As we learned earlier, there’s one column per variable
and one row per observation. <code>data.frame</code>s are simply collections of variables:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(num, char, fac)</span></code></pre></div>
<p><br />
</p>
<p>To access variables in a data.frame, you simply use the <code>$</code> dollar sign.</p>
<pre><code>data$num</code></pre>
<p><br />
</p>
<p>You can read in <code>data.frame</code>s from your own data: and you’ll learn much more
about that next time…<br />
<br />
</p>
<hr />
</div>
</div>
<div id="final-tips" class="section level2">
<h2><span class="header-section-number">2.5</span> FINAL TIPS</h2>
<p>Use <code>?</code> to get help on a function. These help pages take a while to get used
to, but they lay out what arguments a function takes, what those arguments
are, what the output (value) of the function is, and some examples.<br />
<br />
</p>
<p>The internet is really useful. As you get used to R, you’ll be able to find
blogs and articles and forums that give you answers. There are also R mailing
lists, but it’s best not to email them until you’re sure you’ve done everything
you can to solve your problem.<br />
<br />
</p>
<p>If something goes wrong with your R coding (usually Errors), then 99.9% of the
time it’s because you’ve made a mistake. R is very literal. Be careful!<br />
<br />
</p>
<p>_Task: what are the errors (‘bugs’) in the lines of code below?</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>mynums &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">4</span>, <span class="dv">40</span>, <span class="dv">4</span>,)</span>
<span id="cb52-2"><a href="#cb52-2"></a>mychar &lt;-<span class="st"> </span>LETTERS[<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">21</span><span class="op">:</span><span class="dv">26</span>)]</span>
<span id="cb52-3"><a href="#cb52-3"></a><span class="kw">length</span>(Mychar)</span></code></pre></div>
<p><br />
</p>
<p>These are really common mistakes to make. Be aware!</p>
<!--chapter:end:02_Rbasics.Rmd-->
<!-- spiel -->
</div>
</div>
<div id="single-variable-plots" class="section level1">
<h1><span class="header-section-number">3</span> SINGLE VARIABLE PLOTS</h1>
<p>For this worksheet, it may be useful to continue your “Data Handling” .R file,
as we will be using some of the data subsetting techniques that we learned
last week. As you complete this worksheet, copy the code that the ShinyGLiM
app shows you into your .R file, and run it using the ‘games’ data in R. Hopefully
you can create the same plots that the ShinyGLiM app shows you :)</p>
<p>Remember: typing code really is better than copy-pasting, as it helps the R language stick in your
brain better.</p>
<p>The first part of this worksheet contains <em>Questions</em> and <em>Tasks</em> in <em>italics</em>: note
down the answers you get, and we’ll go through them at the end of the session.</p>
<p>The second part of this worksheet contains some tasks for you to complete with a
real data set. There will be several choices of data sets to work with, each with a different
question or hypothesis suggested by me, although I am perfectly happy for
you to pursue different questions or hypotheses instead.
From this point (week 2) until week 8, you’ll develop
your coding with the data &amp; hypothesis you choose, until you’ve gone through the whole<br />
Tidy Data –&gt; Plot –&gt; Model –&gt; Model Check –&gt; Results<br />
process. In week 8 we’ll review what you’ve achieved, and what useful points there
are to bring forward to your project at the end of the module.<br />
<br />
</p>
<!-- Resources -->
<hr />
<div id="resources" class="section level2">
<h2><span class="header-section-number">3.1</span> RESOURCES</h2>
<p>Books:</p>
<ul>
<li>Beckerman, Childs &amp; Petchey (2017) <em>Getting started with R, an
introduction for Biologists</em>, 2nd ed. pp 87 - 91, Chapter 4.4, “Distributions:
making histograms of numeric variables”, &amp; Chapter 4.5, “Saving your graphs for
presenatation, documentation, etc.”.
 </li>
</ul>
<p>Cheatsheets:</p>
<ul>
<li>ggplot2 cheatsheet - see Resources section on blackboard or
download <a href="https://rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf">here</a>
 </li>
</ul>
<p>Web links:</p>
<ul>
<li><p><a href="https://ggplot2.tidyverse.org/">gpglot2</a> by RStudio<br />
 </p></li>
<li><p><a href="https://iainmstott.shinyapps.io/ShinyGLiM"><strong>ShinyGLiM</strong></a><br />
</p></li>
</ul>
</div>
<div id="packages" class="section level2">
<h2><span class="header-section-number">3.2</span> PACKAGES</h2>
<p>You’ll need to load the right packages every time you complete worksheets. In
this session, we will be working with:</p>
<ul>
<li><code>readr</code>, which helps load in data</li>
<li><code>dplyr</code>, which is our data subsetting and manipulation friend</li>
<li><code>ggplot2</code>, which makes pretty pretty data visualisations.</li>
</ul>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="kw">library</span>(readr)</span>
<span id="cb53-2"><a href="#cb53-2"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb53-3"><a href="#cb53-3"></a><span class="kw">library</span>(ggplot2)</span></code></pre></div>
<p><br />
</p>
<hr />
</div>
<div id="plotting-single-variables" class="section level2">
<h2><span class="header-section-number">3.3</span> PLOTTING SINGLE VARIABLES</h2>
<p>It’s really important to understand the nature of your data. There are different
types of data, and here are some of the types we regularly encounter as ecologists:</p>
<ul>
<li>numeric
<ul>
<li>continuous: Gaussian, beta, exponential</li>
<li>discrete (counts): Poisson, binomial</li>
</ul></li>
<li>non-numeric
<ul>
<li>categorical</li>
<li>ordinal<br />
</li>
</ul></li>
</ul>
<p>In this course we’ll be primarily focusing on three of the most common types
of data we deal with as dependent variables in ecology: Gaussian (normal),
Poisson and binomial (…although the independent variables we work with
will be of other types too; certainly we’ll work with categorical independent variables).</p>
<p>The <strong>distributions</strong> of these variables are important factors in how we
interpret plots and analyses. Distributions are effectively ‘counts’ of the
number of times certain variable values occur (e.g. for the paper balls game
the counts of occurrence of 0, 1, 2, 3, 4,…), or the number of times variable
values occur within certain intervals (e.g. for the forward fold the number of
values between -3 to -2, -2 to -1, -1 to 0,…). Distributions show us how variables are
<strong>bounded</strong> (i.e. cannot occur above, below or between certain values),
how they are <strong>skewed</strong> (e.g. there are lots of small values but not many large ones),
which <strong>statistical distributions</strong> the data approximate, and what that means
for their <strong>moments</strong> (mean, variance, skewness). All of these things can have implications
for how you analyse your data, and how you interpret your results.</p>
<p>In this particular session, we’re going to acquaint ourselves with the
<a href="https://ggplot2.tidyverse.org/"><code>ggplot2</code></a> package. <code>ggplot2</code> is a great
package for data visualisation: it’s easy to make very pretty graphs with
only a few lines of code, and has simplified many data visualisation problems
which previously were tricky in R. We’ll be learning:</p>
<ul>
<li>a reinforcement of data-handling skills</li>
<li>an understanding of the grammar of graphics and how ggplot uses it</li>
<li>how plot histograms
<ul>
<li><code>ggplot()</code> and <code>aes()</code> to initialise a plot</li>
<li>adjustments to coordinates</li>
<li><code>geom_histogram</code> to map a histogram</li>
<li>how to change the look of a plot with themes and other options<br />
<br />
</li>
</ul></li>
</ul>
<hr />
<hr />
</div>
<div id="part-1" class="section level2">
<h2><span class="header-section-number">3.4</span> PART 1</h2>
<p><br />
</p>
</div>
<div id="user-guide" class="section level2">
<h2><span class="header-section-number">3.5</span> USER GUIDE</h2>
<p>Reacquaint yourself with the USER GUIDE, as it may be able to answer some of
your questions!<br />
<br />
</p>
</div>
<div id="subsetting-data" class="section level2">
<h2><span class="header-section-number">3.6</span> SUBSETTING DATA</h2>
<p>Remind yourself how to subset data, as we’ll be re-using these skills every week
from now on.<br />
<br />
</p>
</div>
<div id="data-visualisation-one-variable" class="section level2">
<h2><span class="header-section-number">3.7</span> DATA VISUALISATION (ONE VARIABLE)</h2>
<p>This new page shows how to code single-variable plots (histograms) in R using
<code>ggplot2</code>.<br />
</p>
<div id="forward-fold" class="section level3">
<h3><span class="header-section-number">3.7.1</span> FORWARD FOLD</h3>
<p>We’re going to begin by working with the forward fold (<code>ffold</code>) variable. For now,
we’ll keep all of the data points, so don’t make any changes to the data frame.</p>
<p>Head on over to the DATA VISUALISATION (ONE VARIABLE) page. Choose to plot the
forward fold (<code>ffold</code>) variable. Keep all of the other options at their defaults, for now.</p>
<p><em>Question: how would you describe the distribution of the forward fold variable?
Think about what the characteristics of a distribution are, and what characteristics
this distribution has. Think about what characteristics you would expect the
distribution to have. Do your expectations match the reality?</em><br />
<br />
</p>
<p>Now try adjusting the number of bins that you’re plotting. Try higher numbers, and try lower.
As you adjust the number of bins, look at the CODE tab to see what changes.</p>
<p><em>Questions:</em></p>
<ul>
<li><em>What happens if you increase the number of bins?</em></li>
<li><em>What happens if you descrease the number of bins?</em></li>
<li><em>What do you think is the perfect bin number to use?</em><br />
</li>
</ul>
<p>Now getting back CODE tab, look at how the code changes as you change the number of bins.</p>
<p><em>Question: when changing the number of bins, which of the following changes in
the code?</em></p>
<ul>
<li>a <strong>function</strong></li>
<li>an <strong>argument</strong></li>
<li>an <strong>object</strong></li>
<li>an <strong>option</strong><br />
</li>
</ul>
<p>You can probably guess by looking at the code how elements of the code match up to the rest of the options in the app.
As I have said all along so far, R is very literal! Have a guess at what
will change in the code if you change the x axis limits, the fill colour for
the bars, and the theme.</p>
<p><em>Questions:</em></p>
<p><em><em>Did the code change in the way you expected, and if not, how was it different? </em>
</em> <em>What’s the best colour to plot the bars with? </em>
* <em>What’s the nicest theme, and are there any other themes than the ones listed?
(Hint: Google is your friend when it comes to finding out new things about R).</em><br />
<br />
</p>
<p>Cast your mind back to the <em>BGY2010M W1.2 Data handling</em> worksheet, because
you’re going to have to remember something you learned! You want to look
at the ‘games’ data for only people who can’t touch the floor, as you have a theory
that their tight muscle tension could mean they have quicker reactions
(the <code>ruler</code> variable).</p>
<p><em>Task: work out (without looking at the app!) which of these three pieces of code
give the correct way to subset the data in the way described above.</em></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="co"># a)</span></span>
<span id="cb54-2"><a href="#cb54-2"></a>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(ffold <span class="op">%over%</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb54-3"><a href="#cb54-3"></a></span>
<span id="cb54-4"><a href="#cb54-4"></a><span class="co"># b)</span></span>
<span id="cb54-5"><a href="#cb54-5"></a>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(ffold <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb54-6"><a href="#cb54-6"></a></span>
<span id="cb54-7"><a href="#cb54-7"></a><span class="co"># c)</span></span>
<span id="cb54-8"><a href="#cb54-8"></a>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(ffold <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb54-9"><a href="#cb54-9"></a></span>
<span id="cb54-10"><a href="#cb54-10"></a><span class="co"># d)</span></span>
<span id="cb54-11"><a href="#cb54-11"></a>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(ffold <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</span></code></pre></div>
<p><br />
</p>
<p>Now, head to the DATA page and subset the data to only people who can’t touch the
floor. See whether you got the above answer right.<br />
<br />
</p>
<p>Returning to the DATA VISUALISATION (ONE VARIABLE) page, see how subsetting
the data has changed your plot.</p>
<p><em>Question: think back to the start of this worksheet and what you thought about
the characteristics of the distribution of the <code>ffold</code> variable. Now that you’ve subsetted the <code>ffold</code> data, have those thoughts changed?</em><br />
<br />
</p>
</div>
<div id="ruler-reaction" class="section level3">
<h3><span class="header-section-number">3.7.2</span> RULER REACTION</h3>
<p>Now plot a histogram of the <code>ruler</code> variable, still just for people who can’t
touch the floor.</p>
<p><em>Question: what x-axis limits should you probably choose?</em><br />
<br />
</p>
<p>Choose what number bins you think works best, and add a
density plot on top. Take a mental (or literal) snapshot of what the plot looks
like. Head back to the DATA page, undo your subset to revert back to the full data set, then see how the plot has changed on the DATA VISUALISATION (ONE VARIABLE) page.</p>
<p><em>Question: Are the two distributions similar, or different? What might that tell
us about the hypothesis?</em><br />
<br />
</p>
</div>
<div id="paper-balls" class="section level3">
<h3><span class="header-section-number">3.7.3</span> PAPER BALLS</h3>
<p>Now, with the whole data set, we’ll plot the distribution of the paper balls
variable. Choose a number of histogram bins that you’re comfortable with, and then add a density plot.</p>
<p><em>Task: Without looking at the CODE tab, find the mistake(s) in the code below
and correct them to give you the code needed to produce the plot.</em></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>hist &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data, <span class="dt">x =</span> pballs)</span>
<span id="cb55-2"><a href="#cb55-2"></a>    <span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..), bins<span class="op">:</span><span class="st"> </span><span class="dv">8</span>, fill<span class="op">:</span><span class="st"> </span>steelblue4) <span class="op">+</span><span class="st"> </span></span>
<span id="cb55-3"><a href="#cb55-3"></a><span class="st">    </span><span class="co"># your bin numbers and colour may be different to above!</span></span>
<span id="cb55-4"><a href="#cb55-4"></a><span class="st">    </span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb55-5"><a href="#cb55-5"></a>    <span class="co"># your xlim may be different to above!</span></span>
<span id="cb55-6"><a href="#cb55-6"></a>    <span class="kw">theme</span>(<span class="st">&quot;minimal&quot;</span>)</span>
<span id="cb55-7"><a href="#cb55-7"></a>    <span class="co"># your theme may be different to above!</span></span>
<span id="cb55-8"><a href="#cb55-8"></a></span>
<span id="cb55-9"><a href="#cb55-9"></a>hist <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">color =</span> <span class="st">&#39;white&#39;</span>, <span class="dt">bars =</span> <span class="st">&#39;darkgrey&#39;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><br />
</p>
<p>Check the code tab to see whether you managed to catch the mistakes properly.</p>
<p><em>Question: what do you think the <code>alpha</code> value does in the <code>geom_density()</code>
function?</em><br />
<br />
</p>
<p>Finally, you may notice that in the <em>Getting started with R</em> book, they don’t
use <code>y = ..density..</code> when plotting histograms. This is included here so that
it’s possible to see the density plot on top. For a probability density histogram,
each bar represents the proportion of the data that takes a certain range of
values. If we use a histogram of counts, it’s the number of data points that
have a certain value.</p>
<p><em>Task: a count histogram is probably more relevant for the <code>pballs</code> variable.
How would we change the code to get counts? (Hint: take a look in the
Getting Started with R book).</em><br />
<br />
</p>
<hr />
<hr />
</div>
</div>
<div id="part-2" class="section level2">
<h2><span class="header-section-number">3.8</span> PART 2</h2>
<p>In this part, we’ll start looking at real data sets. There are several
to choose from, each with a suggested hypothesis, and you can find them in the
DataDescription.html file in the DATA section on Blackboard.<br />
<br />
</p>
<p><em>Tasks: For your chosen data and hypothesis, you need to:</em></p>
<ul>
<li><em>Subset the data by removing any rows (and perhaps columns) which are not
needed.</em></li>
<li><em>Add to the data frame any extra variables you need for your analysis (if any).</em></li>
<li><em>Plot the distributions of the numeric variables you’ll include in your
analysis. At this point, response variables should be variables with Gaussian (normal) distributions (talk to me if you need any clarification on this).</em></li>
<li><em>Draw some conclusions about the distributions of your variables…</em>
<ul>
<li><em>Are the variables continuous (can take any number) or discrete (usually counts)?</em></li>
<li><em>Are they bounded at all?</em></li>
<li><em>Are they skewed, and how does that compare to what you would expect?</em></li>
<li><em>What are their <strong>moments</strong> (mean, variance, median, mode, skewness) likely to be?</em><br />
<br />
</li>
</ul></li>
</ul>
<p>On this last point: moments of data are easy to calculate. You can use, e.g.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="kw">mean</span>(data<span class="op">$</span>pballs) <span class="co"># if there are missing values add na.rm = TRUE</span></span>
<span id="cb56-2"><a href="#cb56-2"></a><span class="kw">median</span>(data<span class="op">$</span>pballs) </span>
<span id="cb56-3"><a href="#cb56-3"></a></span>
<span id="cb56-4"><a href="#cb56-4"></a><span class="co"># calculating other moments requires using a package</span></span>
<span id="cb56-5"><a href="#cb56-5"></a><span class="kw">install.packages</span>(<span class="st">&quot;moments&quot;</span>)</span>
<span id="cb56-6"><a href="#cb56-6"></a><span class="kw">skewness</span>(data<span class="op">$</span>pballs)</span></code></pre></div>
<p> 
 </p>
<!--chapter:end:03_SingleVariablePlots.Rmd-->
</div>
</div>
<div id="data-handling-and-management" class="section level1">
<h1><span class="header-section-number">4</span> DATA HANDLING AND MANAGEMENT</h1>
<p>Create a new .R file in the folder you wish to use as your working directory, to
use in this session.</p>
<p>Tidy Data –&gt; Plot –&gt; Model –&gt; Model Check –&gt; Results.</p>
<p>The worksheet comes in two parts.</p>
<ul>
<li>In the first part, you’ll work with the
<a href="https://iainmstott.shinyapps.io/ShinyGLiM">ShinyGLiM app</a>
to find out what code you would write to achieve certain tasks in R.</li>
<li>In the second part,
you’ll work with real scientific data to apply your new knowledge to real scientific
questions.<br />
<br />
</li>
</ul>
<p>Again, type in the commands rather than copy-pasting…<br />
</p>
<p>Whilst you do part 1, you might want to copy code from the app into your .R
file: in part 2 it might be useful to edit it to get the answers you need!<br />
</p>
<hr />
<div id="resources" class="section level2">
<h2><span class="header-section-number">4.1</span> RESOURCES</h2>
<p>Books:</p>
<ul>
<li>Beckerman, Childs &amp; Petchey (2017) <em>Getting started with R, an
introduction for Biologists</em>, 2nd ed. pp 35 - 78, Chapter 2, “Getting your
data into R” and Chapter 3, “Data management, manipulation and exploration”.
 </li>
</ul>
<p>Cheatsheets:</p>
<ul>
<li>Week 1: data transformation with dplyr cheatsheet by RStudio -
see Resources section on blackboard or download
<a href="https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf">here</a></li>
</ul>
<p>Web links:</p>
<ul>
<li><a href="https://education.rstudio.com/learn/beginner%22">R for beginners</a> by RStudio
 </li>
</ul>
<p><a href="https://iainmstott.shinyapps.io/ShinyGLiM"><strong>ShinyGLiM</strong></a><br />
<br />
</p>
</div>
<div id="packages" class="section level2">
<h2><span class="header-section-number">4.2</span> PACKAGES</h2>
<p>You’ll need to load the right packages every time you complete worksheets. In
this session, we will be working with:</p>
<ul>
<li><code>readr</code>, which helps load in data</li>
<li><code>dplyr</code>, which is our data subsetting and manipulation friend</li>
</ul>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="kw">library</span>(readr)</span>
<span id="cb57-2"><a href="#cb57-2"></a><span class="kw">library</span>(dplyr)</span></code></pre></div>
<p><br />
</p>
<hr />
</div>
<div id="data-handling" class="section level2">
<h2><span class="header-section-number">4.3</span> DATA HANDLING</h2>
<p>We’ve learned some basic stuff in R: objects, classes, assignments, functions,
arguments, outputs, comments. Importantly we’ve learned of a few common classes
of object that we’ll often encounter during our R adventures: numeric,
character, factor, logical, data.frame. We’ve learned how
R works, with the base packages providing the basic functionality, which can be
built upon to get R to work for whatever you might imagine (within reason).
These add-on thingies are called <strong>packages</strong> and you store them in your R
<strong>library</strong>. (R aficionados will tell you not to confuse “package” and “library”:
you load packages, which are stored in youur library, and their brains
explode if you tell them you’re loading the library).</p>
<p>We’ve also learned about <strong>Tidy Data</strong>. Tidy data allows you, as analyst padawans,
to easily subset and manipulate data, so you’re working with the data that you
need to be working with.</p>
<p>In this session, we’re going to learn common means of manipulating data. From
here on, we’ll be using a collection of packages, built by RStudio, called the
<a href="https://www.tidyverse.org"><strong>tidyverse</strong></a> (although we’ll only be using a
few of the ones that are on offer). The tidyverse is a new, emerging way of
programming in R. It’s fast becoming the standard way of coding, athough
old-schoolers like me have taken a while to get used to it.</p>
<p>In this particular session, we’re going to acquaint ourselves with the
<a href="https://dplyr.tidyverse.org/"><code>dplyr</code></a> package. <code>dplyr</code> is an expert
data-wrangler which you can use to organise and manipulate data ready for
plotting and analysis. We’ll be learning:</p>
<ul>
<li>how to read data into R</li>
<li>how to subset data
<ul>
<li><code>slice()</code> and <code>filter()</code> to choose certain rows of the <code>data.frame</code></li>
<li><code>select()</code> to choose certain columns of the <code>data.frame</code></li>
</ul></li>
<li>how to manipulate data
<ul>
<li>how to add a variable to the <code>data.frame</code> using <code>mutate()</code></li>
<li>how to arrange the <code>data.frame</code> by variable values using <code>arrange()</code></li>
</ul></li>
<li>how to use <strong>pipes</strong> to make coding neater and cleaner.<br />
<br />
</li>
</ul>
<hr />
<hr />
</div>
<div id="part-1" class="section level2">
<h2><span class="header-section-number">4.4</span> PART 1</h2>
<p><br />
</p>
</div>
<div id="user-guide" class="section level2">
<h2><span class="header-section-number">4.5</span> USER GUIDE</h2>
<p>Read the USER GUIDE for ShinyGLiM. At this point, we’ll just be working on the
first step: <em>Tidy Data</em>. The first thing you want to do, on the User Guide page,
is choose your data. However for now there’s only one data set: the ‘games’
data we collected last week… plus some extra data: and yes, I made some of your
other lecturers do the tasks too!<br />
<br />
</p>
</div>
<div id="subsetting-data" class="section level2">
<h2><span class="header-section-number">4.6</span> SUBSETTING DATA</h2>
<p>On the DATA tab, you can see the games data. There are two panels on the right
hand side: DATA FRAME and CODE (if your browser window is narrow or you’re
using a smartphone or a tablet then these might be at the bottom of the
page). Click on the CODE tab. These two lines of
code are what you need to read in the games data and get R to show it.</p>
<p>On the left are some options. You can choose rows by row numbers or variable
values, and columns by column numbers or column names.<br />
<br />
</p>
<div id="slice" class="section level3">
<h3><span class="header-section-number">4.6.1</span> <code>slice()</code></h3>
<p>First we’ll pick some rows by their number using <code>slice</code>. Change the row numbers
slider to pick a subset of the dataframe rows.</p>
<ul>
<li>check that the DATA FRAME displayed has changed like you expect it to</li>
<li>take a look at the CODE panel to see how it’s changed</li>
</ul>
<p><em>Question: which of the above topics (reading data, <code>slice()</code>, <code>filter()</code>,
<code>select()</code>, <code>mutate()</code>, pipe) are we using in this code?</em><br />
<br />
</p>
<p>Note how we assign <code>&lt;-</code> the smallest and largest row values to
<code>rows</code> and then use these values later to subset the data with <code>seq()</code> and
<code>slice()</code>.</p>
<p><em>Question: Why might we want to take this approach rather than just using
the values directly?</em></p>
<p><em>Question: Based on what you learned in the basic R worksheet, how could you
achieve the same subset of data with a slightly different approach in
specifying the rows to take out?</em><br />
<br />
</p>
<p>You’ll notice that we use a <strong>pipe</strong> <code>%&gt;%</code> in this code:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>dataSubset &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2"></a><span class="st">    </span><span class="kw">slice</span>( <span class="kw">seq</span>(rows[<span class="dv">1</span>], rows[<span class="dv">2</span>], <span class="dv">1</span>) )</span></code></pre></div>
<p>The pipe is a way of taking whatever you have and then passing it to the next
function. So, here we take <code>data</code>, and then pass it to <code>slice()</code> to chop out
some rows. We could do this a different way without a pipe:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>dataSubset &lt;-<span class="st"> </span><span class="kw">slice</span>(data, <span class="kw">seq</span>(rows[<span class="dv">1</span>], rows[<span class="dv">2</span>], <span class="dv">1</span>) )</span></code></pre></div>
<p>For something short like we’re doing here, this might make sense. But as you
need to do more and more things with your data, this gets more complicated as
you end up with functions inside functions, parentheses within parentheses…<br />
<br />
</p>
</div>
<div id="select" class="section level3">
<h3><span class="header-section-number">4.6.2</span> <code>select()</code></h3>
<p>As an example of how the pipe is useful, let’s also choose certain columns.
For now we’ll choose by column number. Pick “Choose by… Column numbers” and
change the slider to whatever values you want. Check the DATA FRAME to check
you have the right ones, then check the CODE to see what you have. Notice that
there’s a further step in the data subsetting.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>dataSubset &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span></span>
<span id="cb60-2"><a href="#cb60-2"></a><span class="st">    </span><span class="kw">slice</span>( <span class="kw">seq</span>(rows[<span class="dv">1</span>], rows[<span class="dv">2</span>], <span class="dv">1</span>) ) <span class="op">%&gt;%</span></span>
<span id="cb60-3"><a href="#cb60-3"></a><span class="st">        </span><span class="kw">select</span>( <span class="kw">seq</span>(cols[<span class="dv">1</span>], cols[<span class="dv">2</span>], <span class="dv">1</span>) ) </span></code></pre></div>
<p><em>Question: using information from the R basics worksheet, how would you choose
columns (or rows) that aren’t in a sequence, for example only columns 2 and 4?</em><br />
<br />
</p>
<p>Let’s imagine what that the above code would look like without pipes…</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>dataSubset &lt;-<span class="st"> </span><span class="kw">select</span>(<span class="kw">slice</span>(data, <span class="kw">seq</span>(rows[<span class="dv">1</span>], rows[<span class="dv">2</span>], <span class="dv">1</span>) ), <span class="kw">seq</span>(cols[<span class="dv">1</span>], cols[<span class="dv">2</span>], <span class="dv">1</span>))</span></code></pre></div>
<p>Yeah, not great. Lesson: pipes <em>are</em> great!<br />
<br />
</p>
<p>Most of the time we don’t want to (or more accurately shouldn’t) select a
column using its number. We have variables, and those variables are named,
and we’re much less likely to make a mistake if we use those names rather
than picking the wrong number. Choose the option to choose columns using variable
names, and take out whichever ones you feel like. Note how the code then changes,
and you’re selecting variables by name instead of by number. That’s way more trustworthy.</p>
<p><em>Question: What could you write instead of the code you now see, if you just
wanted to remove one of the variables? Hint… the answer can be found in the
section on ´select()´ in Getting Started with R.</em><br />
<br />
</p>
</div>
<div id="filter" class="section level3">
<h3><span class="header-section-number">4.6.3</span> <code>filter()</code></h3>
<p>Selecting rows using numbers is also not the best way to go about things. Choose
the option to select rows using variable values.</p>
<p>There’s a bit more thinking with this one. Cast your brain back to the R basics
worksheet and what a <em>logical</em> is. In the text box you can see there, you can type
any logical that involves any of the variables, using any of the logical
operators you encountered in the R basics exercise (or other ones as well if you
know them!). Think about whether the variable is continuous or categorical, and
which logical operators work with which variables. Here are some ideas to
start: <code>pict_cards &gt;= 1</code> gives you every person who got at least 1 picture card;
<code>role == "student"</code> gives you all the values for students.</p>
<p><em>Task: subset the data to rows for people with negative forward fold numbers.
If you think you know how, subset the data to rows for people with negative
forward fold numbers</em> <strong>&amp;</strong> <em>who are students. Hint: there’s a bold statement
there indicating how you might do that.</em><br />
</p>
</div>
</div>
<div id="adding-variables" class="section level2">
<h2><span class="header-section-number">4.7</span> ADDING VARIABLES</h2>
<p>Sometimes we might want to add a variable to the data frame that’s some kind of
function of one or more other variables.<br />
<br />
</p>
<div id="mutate" class="section level3">
<h3><span class="header-section-number">4.7.1</span> <code>mutate()</code></h3>
<p><code>mutate()</code> is the function we’ll use to add variables. Imagine, for example,
that you realised your ruler was snapped and started at 5cm. That would mean all
the reaction measures are 5cm too high! So, choose the option to add a variable.
Pick a name for this corrected reaction measure, write in the correct code for its
value and add it to the data. Take a look at the code to see what’s changed.</p>
<p><em>Question: is it possible to add this variable before we subset the data? Would
we always want to add afterwards, or before, or a mix?</em><br />
</p>
<hr />
</div>
</div>
<div id="part-2" class="section level2">
<h2><span class="header-section-number">4.8</span> PART 2</h2>
<p>We’ll now put some of that learning into practise with a few tasks with the
data. Try and complete these on your own, without consulting the app, and
I’m sure you copied the code over from the app as was suggested, so you can
edit that as you need to. First, pretty simple, but pretty important…<br />
<br />
</p>
<p><em>Task: read in the games data</em><br />
<br />
</p>
<p>You’re interested in whether luck truly is a real thing in life, as you think
men are unluckier than any other gender. Drawing a picture card is unlucky, as
picture cards look at you funny and you’re pretty sure they’re up to no good.
Drawing a black card is luckier than drawing a red card, as red is the colour
of the devil. There are several steps to preparing your data…</p>
<p><em>Task: prepare your lucky, lucky data…</em></p>
<ul>
<li><em>You don’t want to use any data from people who drew 4 cards, as 4 represents
the 4 horsemen of the apocalypse. Remove any data where someone chose 4 cards.</em></li>
<li><em>You don’t care about any variable that isn’t associated with the cards, except
for the identity of the person: their gender and their group. Get rid of the
variables you don’t care about.</em></li>
<li><em>You need to know how many non-picture cards there were for each person, so
calculate that and add it to your data.</em><br />
</li>
</ul>
<p><em>Questions:</em></p>
<ul>
<li><em>How many rows of data do you have left?</em></li>
<li><em>What function would you use to arrange the rows of the data frame by the number of
picture cards drawn? (Hint: see the Getting Started with R book)… can you
write the code that would do that?</em></li>
<li><em>What’s the mean total number of black cards drawn?</em></li>
<li><em>What are the mean numbers of picture cards drawn, separately for each gender?
Hint: you can look at p. 71 of Getting Started With R for this one, and we’ll
encounter it later in the course as well.</em><br />
</li>
</ul>
<hr />
</div>
<div id="final-tips" class="section level2">
<h2><span class="header-section-number">4.9</span> FINAL TIPS</h2>
<p>That’s a whistle-stop tour in data tidying. I’d encourage you to also look at
p.75 of <em>Getting Started With R</em> which shows how this information maps on to
the <em>base-R</em> methods for working with <code>data.frame</code>s. Most people will use these,
and they can sometimes be quicker and easier when you just have something
very simple to do (this is a general rule with the <code>tidyverse</code> packages:
often if you have something quick to do, then the base-R approach is better).
Either approach is equally as valid.<br />
<br />
</p>
<p>Note how I write R code: where there are spaces, what the indentation looks like,
etc. This is code <em>formatting</em> and there’s an accepted standard for what it
should look like. Confusingly, it does matter in some instances where you do or
do not put a space, but most of the time you can put a space (in fact as many spaces
as you like), wherever you want. It’s not the end of the world if you don’t keep
to the proper standards, but it does make code way easier to read.</p>
<!--chapter:end:04_DataHandling.Rmd-->
</div>
</div>
<div id="two-variable-plots" class="section level1">
<h1><span class="header-section-number">5</span> TWO-VARIABLE PLOTS</h1>
<!-- spiel -->
<p>As you complete Part 1 of this worksheet, you may find it useful to copy the code that the ShinyGLiM
app shows, into the .R file you’ve been using for the ‘games’ data. Hopefully
you can create the same plots that the ShinyGLiM app shows you :)</p>
<p>Remember again: typing code really is better than copy-pasting, as it helps the R language stick in your
brain better.</p>
<p>The first part of this worksheet contains <em>Questions</em> and <em>Tasks</em> in <em>italics</em>: note
down the answers you get, and we’ll go through them at the end of the session.</p>
<p>The second part of this worksheet continues our adventures with our real data sets.
Having worked out how we need to subset the data, and looked at the distribution(s)
of the variable(s) we’re working with, we’re now going to see how those variables
relate to one another.<br />
</p>
<!-- Resources -->
<hr />
<div id="resources" class="section level2">
<h2><span class="header-section-number">5.1</span> RESOURCES</h2>
<p>Books:</p>
<ul>
<li>Beckerman, Childs &amp; Petchey (2017) <em>Getting started with R, an
introduction for Biologists</em>, 2nd ed. pp 79 - 92, Chapter 4, “Visualizing
your data”. Extra delectable content on pimping your plots on pp 203-218,
Chapter 8, “Pimping your plots: scales and themes in <code>ggplot2</code>”.
 </li>
</ul>
<p>Cheatsheets:</p>
<ul>
<li>ggplot2 cheatsheet - see Resources section on blackboard or
download <a href="https://rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf">here</a>
 </li>
</ul>
<p>Web links:</p>
<ul>
<li><p><a href="https://ggplot2.tidyverse.org/">gpglot2</a> by RStudio<br />
 </p></li>
<li><p><a href="https://iainmstott.shinyapps.io/ShinyGLiM"><strong>ShinyGLiM</strong></a><br />
<br />
</p></li>
</ul>
</div>
<div id="packages" class="section level2">
<h2><span class="header-section-number">5.2</span> PACKAGES</h2>
<p>You’ll need to load the right packages every time you complete worksheets. In
this session, we will be working with:</p>
<ul>
<li><code>readr</code>, which helps load in data</li>
<li><code>dplyr</code>, which is our data subsetting and manipulation friend</li>
<li><code>ggplot2</code>, which makes pretty pretty data visualisations.</li>
</ul>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="kw">library</span>(readr)</span>
<span id="cb62-2"><a href="#cb62-2"></a><span class="kw">library</span>(dplyr)</span></code></pre></div>
<pre><code>## Warning: package &#39;dplyr&#39; was built under R version 3.6.1</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="kw">library</span>(ggplot2)</span></code></pre></div>
<p><br />
</p>
<hr />
</div>
<div id="plotting-multiple-variables" class="section level2">
<h2><span class="header-section-number">5.3</span> PLOTTING MULTIPLE VARIABLES</h2>
<p>Of course as scientists, what we really want to know is how a variable, let’s
call it the <em>dependent variable</em>, the <em>response variable</em>, the <em>y variable</em> is
affected by another variable, which we could call the <em>independent variable</em>, the
<em>explanatory variable</em>, the <em>x variable</em>.</p>
<p>In fact, those things are what we do call these variables, and there are more
terms besides those. Different fields and different people like to use different
terms. We’re generally going to use the terms <em>dependent</em> and <em>independent</em>,
which generally refer to the <em>y</em> and <em>x</em> variables respectively. But
some points to consider are:</p>
<ul>
<li>does the dependent variable depend on the independent variable?</li>
<li>is the independent variable in fact independent?</li>
<li>does the response variable actually respond to the explanatory variable? If
it doesn’t, is the explanatory variable really explanatory?</li>
<li>do we plot the dependent variable on the y axis and the independent
variable on the x axis?</li>
</ul>
<p><em>Question: For each of the above questions, would you answer yes, or no?</em><br />
<br />
</p>
<p>In this session, we’re going to reacquaint ourselves with the
<a href="https://ggplot2.tidyverse.org/"><code>ggplot2</code></a> package. This time we’ll be seeing
how variables relate to one another, and whether some variables may perhaps
be influencing others. We’ll be learning:</p>
<ul>
<li>another reinforcement of data-handling skills</li>
<li>more about the grammar of graphics</li>
<li>how plot two continuous variables against one another
<ul>
<li>scatterplots using <code>geom_point()</code></li>
</ul></li>
<li>how to plot a categorical independent variable against a continuous dependent variable
<ul>
<li>box plots using <code>geom_boxplot()</code></li>
<li>violin plots using <code>geom_violin()</code></li>
<li>bar plots using <code>geom_bar()</code></li>
</ul></li>
</ul>
<p>We’ll also learn a little more about customising plots.<br />
<br />
</p>
<hr />
<hr />
</div>
<div id="part-1" class="section level2">
<h2><span class="header-section-number">5.4</span> PART 1</h2>
<p><br />
</p>
</div>
<div id="user-guide" class="section level2">
<h2><span class="header-section-number">5.5</span> USER GUIDE</h2>
<p>Reacquaint yourself with the USER GUIDE, as it may be able to answer some of
your questions!<br />
<br />
</p>
</div>
<div id="subsetting-data" class="section level2">
<h2><span class="header-section-number">5.6</span> SUBSETTING DATA</h2>
<p>For this exercise, our dependent variable is going to be the <code>ffold</code> variable.</p>
<p><em>Question: what statistical distribution does the <code>ffold</code> variable follow?</em><br />
<br />
</p>
<p>Our independent variables are going to be the <code>pballs</code> variable and the
<code>ruler</code> variable (but we’ll also see how other categorical variables impact
a person’s ability to forward fold). Our hypothesis is that people who have
quick reactions and good aim must be sporty, and therefore be flexible.</p>
<p>Because we’re working with the <code>ffold</code> variable, we might want to cut out
one group who didn’t have that measured (group 5). That means we only want the first
20 rows of data.</p>
<p><em>Question: pick the correct line of code to subset the data to the first 20 rows.</em></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="co"># a)</span></span>
<span id="cb65-2"><a href="#cb65-2"></a>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rows</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">20</span>))</span>
<span id="cb65-3"><a href="#cb65-3"></a></span>
<span id="cb65-4"><a href="#cb65-4"></a><span class="co"># b)</span></span>
<span id="cb65-5"><a href="#cb65-5"></a>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="dv">1</span>))</span>
<span id="cb65-6"><a href="#cb65-6"></a></span>
<span id="cb65-7"><a href="#cb65-7"></a><span class="co"># c)</span></span>
<span id="cb65-8"><a href="#cb65-8"></a>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(rows <span class="op">&lt;=</span><span class="st"> </span><span class="dv">20</span>)</span>
<span id="cb65-9"><a href="#cb65-9"></a></span>
<span id="cb65-10"><a href="#cb65-10"></a><span class="co"># d)</span></span>
<span id="cb65-11"><a href="#cb65-11"></a>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="kw">rows</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>))</span></code></pre></div>
<p><br />
</p>
<p>You can now use the app to check whether you were right by going to the
DATA page, changing the row numbers slider and checking the CODE tab
(the code may not be exactly the same as above, but hopefully you can see which
function to use and that the two different lines of code will have the same result).<br />
<br />
</p>
</div>
<div id="data-visualisation-two-variables" class="section level2">
<h2><span class="header-section-number">5.7</span> DATA VISUALISATION (TWO VARIABLES)</h2>
<p>Now that we’ve subset the data, we can head right on to the DATA VISUALISATION
(TWO VARIABLES) page. Choose <code>ffold</code> as your “dependent (y) variable”. Note that:</p>
<ul>
<li>currently, the x variable is the first variable in the data, which should be
<code>person</code>.</li>
<li>the “Plot type” is set to “points” (scatter plot).</li>
</ul>
<p><code>person</code> is a categorical variable, but as you can see, it’s still possible to
plot a scatter plot anyway.</p>
<p><em>Question: in this plot, what does each point represent?</em><br />
<br />
</p>
<p>We’d normally use something different like a box plot to plot a continuous
dependent variable against a categorical x variable. Try selecting box plot from
the “Plot type” list.</p>
<p><em>Question: the box plot should just have a single horizontal line for each
person. Why is this?</em><br />
<br />
</p>
<div id="scatter-points-plots" class="section level3">
<h3><span class="header-section-number">5.7.1</span> SCATTER (POINTS) PLOTS</h3>
<p>We’re interested, in fact, in the <code>pballs</code> and <code>ffold</code> variables. Choose
<code>pballs</code> as the independent (x) variable. You should end up with a graph something
like this:<br />
<br />
</p>
<p><img src="DSftLS_book_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>Thinking about our hypothesis that
better aim will mean better flexibility…</p>
<p><em>Questions: what can we say about this graph, in terms of…</em></p>
<ul>
<li><em>what is the trend?</em></li>
<li><em>does the trend support our hypothesis?</em></li>
<li><em>are there any potential outliers or points with high influence over the trend?</em><br />
<br />
</li>
</ul>
<p>OK, so this is a pretty beautiful graph, I think you’ll agree.</p>
<p><em>Question: do you agree?</em><br />
<br />
</p>
<p>We can easily make this graph ourselves. Click on the CODE tab and you’ll see a
short chunk of code that makes this graph. If you’re coding alongside this worksheet,
copy this over and see if you can recreate the plot.</p>
<p>There are various bits to this code, and because code is quite literal, you can
probably guess where to change things to make this plot look a little different.
Here’s a relatively big task: using your educated intuition…</p>
<p><em>Task: copy this chunk of code and edit it so that:</em></p>
<ul>
<li><em>The y axis has limits of -20 and 30</em></li>
<li><em>The points are “slategrey” colour</em></li>
<li><em>The x axis has a label saying “Paper balls”</em></li>
<li><em>The y axis has a label saying “Forward fold”</em><br />
<br />
</li>
</ul>
<p>Now change those variables using the controls in the DATA VISUALISATION
(TWO VARIABLES) page to see whether you got it right.</p>
<p>Hint: you don’t always have to include everything. We could exclude the
<code>ylim()</code>, <code>ylab()</code>, <code>xlab()</code> and theme functions, and eliminate the arguments
from the <code>geom_point()</code> function. We’d still get a graph, just plotted with all the
default arguments and values.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="co"># initialise</span></span>
<span id="cb66-2"><a href="#cb66-2"></a>plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(dataSubset, <span class="kw">aes</span>(<span class="dt">x =</span> pballs, <span class="dt">y =</span> ffold)) <span class="op">+</span></span>
<span id="cb66-3"><a href="#cb66-3"></a><span class="st">    </span><span class="co"># plot a histogram (geom)</span></span>
<span id="cb66-4"><a href="#cb66-4"></a><span class="st">    </span><span class="kw">geom_point</span>()</span>
<span id="cb66-5"><a href="#cb66-5"></a></span>
<span id="cb66-6"><a href="#cb66-6"></a>plot</span></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="DSftLS_book_files/figure-html/unnamed-chunk-41-1.png" width="672" /><br />
</p>
<p><em>Question: What do you think this warning message could mean? (Hint: look
at the data and pay attention to the <code>role</code> and any missing data in <code>ffold</code>).</em><br />
<br />
</p>
<p>We’ve made some conclusions about the link between a person’s ability to
aim paper balls at a wastepaper basket, and their ability to fold themselves in half.
Now we want to know whether someone’s reaction time influences their ability
to fold themselves in half. If you change the “independent (x) variable” to
<code>ruler</code> then you should get a plot something like this:<br />
<br />
<img src="DSftLS_book_files/figure-html/unnamed-chunk-42-1.png" width="672" /><br />
</p>
<p>I changed the colour of the points, for a bit of a change. If you’re coding
alongside reading, you don’t have to change the colour
(or please feel free to pick any colour you like!)</p>
<p>Same <em>Questions</em> here:</p>
<ul>
<li><em>what is the trend?</em></li>
<li><em>does the trend support our hypothesis?</em></li>
<li><em>are there any potential outliers or points with high influence over the trend?</em><br />
<br />
</li>
</ul>
<p>Although these are the variables we’re interested in, there are other things that
might affect the dependent variable, and they’re worth checking out. Change the
independent (x) variable to gender.</p>
<p><em>Question: Which grammar of graphics “layer” will this change in x variable affect?</em></p>
<ul>
<li><em>geometries</em></li>
<li><em>data</em></li>
<li><em>theme</em></li>
<li><em>aesthetics</em></li>
<li><em>facets</em><br />
</li>
</ul>
<p>Your graph should look something like this (but with a different colour):<br />
<br />
<img src="DSftLS_book_files/figure-html/unnamed-chunk-43-1.png" width="672" /><br />
</p>
<p>Points are not really a helpful way to visualise data in groups, although
we can sometimes tell something from them.</p>
<p><em>Question: which gender has the larger variance in <code>ffold</code>?</em></p>
<ul>
<li><em>female</em></li>
<li><em>male</em><br />
<br />
</li>
</ul>
</div>
<div id="box-plots" class="section level3">
<h3><span class="header-section-number">5.7.2</span> BOX PLOTS</h3>
<p>A more helpful way to look at these two variables is using a box plot:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(dataSubset, <span class="kw">aes</span>(<span class="dt">x =</span> gender, <span class="dt">y =</span> ffold)) <span class="op">+</span></span>
<span id="cb68-2"><a href="#cb68-2"></a><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">color =</span> <span class="st">&#39;goldenrod&#39;</span>, <span class="dt">fill =</span> <span class="st">&#39;papayawhip&#39;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb68-3"><a href="#cb68-3"></a><span class="st">        </span><span class="co"># some colour names are ridiculous...</span></span>
<span id="cb68-4"><a href="#cb68-4"></a><span class="st">    </span><span class="kw">ylim</span>(<span class="op">-</span><span class="dv">15</span>, <span class="dv">28</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&#39;Forward fold&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&#39;Gender&#39;</span>) <span class="op">+</span></span>
<span id="cb68-5"><a href="#cb68-5"></a><span class="st">    </span><span class="kw">theme_minimal</span>()</span>
<span id="cb68-6"><a href="#cb68-6"></a></span>
<span id="cb68-7"><a href="#cb68-7"></a>plot</span></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="DSftLS_book_files/figure-html/unnamed-chunk-44-1.png" width="672" /><br />
</p>
<p>Our <code>fill</code> argument has actually come into some use now! (There are some
points that have an outline and a fill: if you want to give it a try then try
changing the <code>shape</code> argument in one of the earlier plots that use
<code>geom_point()</code>). Some of the R colours have crazy names. You can also specify
colours using <a href="https://www.w3schools.com/colors/colors_picker.asp">hex values</a>
if you like.</p>
<p>The box plot shows us a little about the distribution of our data. If the
quartiles are close to the median, then the distribution has a low variance.</p>
<p><em>Question: can a box plot also tell us something about the skewness? If so, how?</em><br />
<br />
</p>
</div>
<div id="violin-plots" class="section level3">
<h3><span class="header-section-number">5.7.3</span> VIOLIN PLOTS</h3>
<p>Box plots are one of the oldest and most commonly used methods of visualising a
continuous versus categorical variable, but <code>ggplot2</code> offers up another, newer
one in the form of a “violin” plot. Choose “violin” as the plot type.</p>
<p><em>Question: take a guess at what the <code>geom</code> function will be to plot a violin
plot (i.e. points is <code>geom_point()</code>, boxplot is <code>geom_boxplot()</code>)…</em></p>
<p><br />
</p>
<p>Remembering back to the density plots of last week, a violin plot is essentially
a density plot for different groups. Just as with other density plots, it has its
drawbacks: you can see the whole distribution, but it’s not possible
to discern the moments of the distribution easily.</p>
<p>It does seem that there are differences between the genders in their forward-folding
abilities. Perhaps not in the mean value, but in the variance at least. We may
want to visualise three variables together: <code>pballs</code> or <code>ruler</code> as the independent
variable, <code>ffold</code> as the depdendent variable, and then an extra grouping of
<code>gender</code>. Think back to earlier plots with <code>pballs</code> or <code>ruler</code> on the x axis and
<code>ffold</code> on the y axis.</p>
<p><em>Question: How could this plot be changed to also show the <code>gender</code> groups?</em><br />
<br />
</p>
</div>
<div id="bar-plots" class="section level3">
<h3><span class="header-section-number">5.7.4</span> BAR PLOTS</h3>
<p>You may be familiar with another means of visualising categorical x continuous
data, called a “barplot” (the fourth option). Please feel free to use bar plots to
explore the data, but be aware that there are distinct disadvantages to
using bar plots, and many researchers are moving away from them nowadays. They
describe very little in terms of the data variance or skewness, because they are just
bars showing the mean for each group. Additionally, because they require the y-axis to
include 0, it can be difficult to see important effects in some data sets
where values of the y variable are large, but variance, and differences between
groups, are very small.<br />
<br />
</p>
</div>
<div id="experimental-design-nonindependence-and-bias" class="section level3">
<h3><span class="header-section-number">5.7.5</span> EXPERIMENTAL DESIGN, NONINDEPENDENCE AND BIAS</h3>
<p>An important thing that we should start thinking about now is nonindependence and
experimental design. In statistical analyses, each observation (data point) is usually
assumed to be <em><strong>independent</strong></em>. This means that there is no way to predict any one
data point from any of the other data points. <strong>NOTE</strong>: there is
the concept of an independent <em>variable</em> (the x variable), which is different
to the concept of independent <em>data</em> (data points not being dependent on one
another). I know it’s confusing, I’m sorry, I don’t make the rules…</p>
<p><em><strong>Nonindependent</strong></em> data is when we <em>can</em> predict any one data point from
another one. This is usually due to some way in which the data are collected,
including spatial and temporal replication. In the ‘games’ data, there is
nonindependence: each <code>group</code> has been tested at a different time, and/or
working together and not with any of the other groups. <code>G1</code> is the guys; <code>G2</code> is the ladies,
<code>G3</code> is some of your lecturers with whom I share an office,
<code>G4</code> is my family, and further groups are incoming. Each group shares
characteristics, may have taken a different approach to playing the games
(note that there are lots of things I <em>didn’t</em> tell you about how to play the games),
have different ages or different variations in ages, and were tested at different
times of the day. All of these things could affect the data: if tested late
in the day, reactions could be slower; if tested in the morning when muscles
are stiffer, people could be worse at the forward
fold than other groups tested in the evening; different groups may have
thought of different ways to do each task… What this means is that data
within each group may be likely to be more similar to one another than to
other data in other groups.</p>
<p><em>Task: plot <code>ffold</code> as the dependent variable and <code>group</code> as the independent
variable. Is there any evidence that data points within groups might
actually be similar to one another in any way?</em><br />
<br />
</p>
<p>Think also about the “experimental design” in the way the data was collected.
There may be biases if one data point was collected in a slightly different
way to another, when they should actually have been collected in exactly the
same way.</p>
<p><em>Task: we’ll have a discussion later about nonindependence and biases in the
‘games’ data. Think and write down possible ideas about where nonindependence
and biases appear in the data.</em><br />
<br />
</p>
<hr />
<hr />
</div>
</div>
<div id="part-2" class="section level2">
<h2><span class="header-section-number">5.8</span> PART 2</h2>
<p>We’re back to working with your data! Use the same .R file as you used for
single variable visualisation, and we will carry on from where we left off.
If you’ve still got some work to do on last week’s tasks, please go for it and let
me know if you need a hand.</p>
<p>By the end of last week’s tasks, you should have:</p>
<ul>
<li>subset the data to remove any rows you don’t need</li>
<li>Added any extra variables (e.g. log-transformations), if you need them</li>
<li>Plot the distributions of numeric variables to assess their bounds,</li>
<li>symmetry, skewness, and other characteristics (if any).<br />
</li>
</ul>
<p><em>Tasks:</em></p>
<ul>
<li><em>according to your hypothesis, identify which variable is your dependent variable.</em></li>
<li><em>according to your hypothesis, identify which variable is your key independent variable.</em></li>
<li><em>identify any further grouping (categorical) variables which may influence the dependent variable.</em></li>
<li><em>in R, using <code>ggplot2</code>, create the most appropriate plots to show:</em>
<ul>
<li><em>what relationship (if any) there is between the dependent and independent variable</em></li>
<li><em>whether and how any other grouping (categorical) variables affect the dependent variable</em></li>
</ul></li>
</ul>
<p>Pay attention to trends in the data, spread of the data, potential outliers,
differences in the mean values and distributions within and between different groups,
and come up with a preliminary statement on whether the plots seems to initially
support the hypothesis, and whether any other variables may need to be taken into account.<br />
<br />
</p>
<!--chapter:end:05_TwoVariablePlots.Rmd-->
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<!--chapter:end:06-references.Rmd-->
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

</body>

</html>
